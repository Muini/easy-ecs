"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _plugin = require("@parcel/plugin");

var _fs = _interopRequireDefault(require("fs"));

var _utils = require("@parcel/utils");

var _path = _interopRequireDefault(require("path"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const HMR_RUNTIME = _fs.default.readFileSync(_path.default.join(__dirname, './loaders/hmr-runtime.js'), 'utf8');

var _default = new _plugin.Runtime({
  apply({
    bundle,
    options
  }) {
    if (bundle.type !== 'js' || !options.hot) {
      return;
    }

    const {
      host,
      port
    } = options.hot;
    return {
      filePath: __filename,
      code: `var HMR_HOST = ${JSON.stringify(host != null ? host : null)};` + `var HMR_PORT = ${JSON.stringify(port != null ? port : null)};` + `var HMR_ENV_HASH = "${(0, _utils.md5FromObject)(bundle.env)}";` + `module.bundle.HMR_BUNDLE_ID = ${JSON.stringify(bundle.id)};` + HMR_RUNTIME,
      isEntry: true
    };
  }

});

exports.default = _default;